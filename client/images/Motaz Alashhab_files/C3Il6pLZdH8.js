/*!CK:3614835436!*//*1456525979,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nglAv"]); }

__d('legacy:ChatTypeaheadBehavior',['ChatTypeaheadBehavior'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.chatTypeahead=function(i){i.enableBehavior(h);};},3);
__d("NotificationConstants",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={PayloadSourceType:{UNKNOWN:0,USER_ACTION:1,LIVE_SEND:2,ENDPOINT:3,INITIAL_LOAD:4,OTHER_APPLICATION:5,SYNC:6}};},null);
__d('NotificationTokens',['CurrentUser'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={tokenizeIDs:function(j){return j.map(function(k){return h.getID()+':'+k;});},untokenizeIDs:function(j){return j.map(function(k){return k.split(':')[1];});}};f.exports=i;},null);
__d('NotificationUpdates',['Arbiter','BizSiteIdentifier.brands','ChannelConstants','JSLogger','NotificationConstants','NotificationTokens','LiveTimer','createObjectFrom'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={},q={},r={},s={},t=[],u=0,v=k.create('notification_updates');function w(){if(u)return;var ba=p,ca=q,da=r,ea=s;p={};q={};r={};s={};y('notifications-updated',ba);if(Object.keys(ca).length)y('seen-state-updated',ca);if(Object.keys(da).length)y('read-state-updated',da);if(Object.keys(ea).length)y('hidden-state-updated',ea);t.pop();}function x(){if(t.length)return t[t.length-1];return l.PayloadSourceType.UNKNOWN;}function y(event,ba){aa.inform(event,{updates:ba,source:x()});}var z=null,aa=Object.assign(new h(),{getserverTime:function(){return z;},handleUpdate:function(ba,ca){if(ca.nodes&&Array.isArray(ca.nodes))ca.nodes=this._filterNodesBasedOnBusinessID(ca.nodes);if(ca.servertime){z=ca.servertime;n.restart(ca.servertime);}if(Object.keys(ca).length)this.synchronizeInforms(function(){t.push(ba);var da=babelHelpers['extends']({payloadsource:x()},ca);this.inform('update-notifications',da);this.inform('update-seen',da);this.inform('update-read',da);this.inform('update-hidden',da);}.bind(this));},didUpdateNotifications:function(ba){Object.assign(p,o(ba));w();},didUpdateSeenState:function(ba){Object.assign(q,o(ba));w();},didUpdateReadState:function(ba){Object.assign(r,o(ba));w();},didUpdateHiddenState:function(ba){Object.assign(s,o(ba));w();},synchronizeInforms:function(ba){u++;try{ba();}catch(ca){throw ca;}finally{u--;w();}},_filterNodesBasedOnBusinessID:function(ba){return ba.filter(function(ca){return ca.business_ids&&Object.keys(ca.business_ids).length>0?!!('business_ids_user_pref' in ca?ca.business_ids_user_pref[i.getBusinessID()]:ca.business_ids[i.getBusinessID()]):!i.isBizSite();});}});h.subscribe(j.getArbiterType('notification_json'),function(ba,ca){var da=Date.now(),ea=ca.obj.nodes;if(ea){ea.forEach(function(fa){fa.receivedTime=da;});v.debug('notifications_received',ea);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,ca.obj);}});h.subscribe(j.getArbiterType('notifications_seen'),function(ba,ca){var da=m.tokenizeIDs(ca.obj.alert_ids);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{seenState:o(da)});});h.subscribe(j.getArbiterType('notifications_read'),function(ba,ca){var da=m.tokenizeIDs(ca.obj.alert_ids);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{readState:o(da)});});h.subscribe(j.getArbiterType('notification_hidden'),function(ba,ca){var da=m.tokenizeIDs([ca.obj.notif_id+'']);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{HiddenState:o(da)});});f.exports=aa;},null);
__d('NotificationStore',['BizSiteIdentifier.brands','KeyedCallbackManager','NotificationConstants','NotificationUpdates','RangedCallbackManager','MercuryServerDispatcher'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=function(s){this.notifications=new i();var t=function(u){var v=this.notifications.getResource(u);return v.creation_time;};this.order=new l(t.bind(this),function(u,v){return v-u;});this.graphQLPageInfo={};},o=h.isBizSite()?h.getBusinessID():null;k.subscribe('update-notifications',function(s,t){var u=t.endpoint||q;if(t.page_info)p[u].graphQLPageInfo=t.page_info;if(t.nodes===undefined)return;var v,w=[],x={},y=t.nodes||[],z;y.forEach(function(aa){v=aa.alert_id;z=p[u].notifications.getResource(v);if(!z||z.creation_time<aa.creation_time){w.push(v);x[v]=aa;}});p[u].notifications.addResourcesAndExecute(x);p[u].order.addResources(w);k.didUpdateNotifications(w);});var p={},q='/ajax/notifications/client/get.php',r={getNotifications:function(s,t){var u=arguments.length<=2||arguments[2]===undefined?q:arguments[2],v=p[u].order.executeOrEnqueue(0,s,function(ca){var da=p[u].notifications.executeOrEnqueue(ca,t);}),w=p[u].order.getUnavailableResources(v);if(w.length){p[u].order.unsubscribe(v);if(!r.canFetchMore(u)){p[u].notifications.executeOrEnqueue(p[u].order.getAllResources(),t);return;}var x=p[u].graphQLPageInfo,y=x&&x.end_cursor||null,z;if(y){var aa=Math.max.apply(null,w),ba=p[u].order.getCurrentArraySize();z=aa-ba+1;}else z=s;m.trySend(u,{businessID:o,cursor:y,length:z});}},getAll:function(s){var t=arguments.length<=1||arguments[1]===undefined?q:arguments[1];r.getNotifications(r.getCount(t),s,t);},getCount:function(){var s=arguments.length<=0||arguments[0]===undefined?q:arguments[0];return p[s].order.getAllResources().length;},canFetchMore:function(){var s=arguments.length<=0||arguments[0]===undefined?q:arguments[0],t=p[s].graphQLPageInfo;return (!t||!t.hasOwnProperty('has_next_page')||t.has_next_page);},registerEndpoint:function(s){if(s&&!(s in p)){p[s]=new n(s);var t={};t[s]={mode:m.IMMEDIATE,handler:function(u){u.endpoint=s;k.handleUpdate(j.PayloadSourceType.ENDPOINT,u);}};m.registerEndpoints(t);}},setBusinessID:function(s){o=s;}};r.registerEndpoint(q);f.exports=r;},null);
__d("XNotificationsOptionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/notifications\/feedback\/option\/",{notif_id:{type:"Int",required:true},undo:{type:"Bool",defaultValue:false},server_action:{type:"String",required:true}});},null);
__d('NotificationUserActions',['AsyncRequest','NotificationConstants','NotificationStore','NotificationTokens','NotificationUpdates','URI','XNotificationsOptionsController','createObjectFrom','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=i.PayloadSourceType.USER_ACTION,r='mark_spam',s='turn_off',t='undo',u='original_subscription_level',v=false;function w(ca){new h('/ajax/notifications/mark_read.php').setData(ca).send();}function x(ca){var da={};ca.forEach(function(ea,fa){da['alert_ids['+fa+']']=ea;});return da;}function y(ca,da,ea,fa,ga){var ha=k.untokenizeIDs([ca])[0],ia={notification_id:ha,client_rendered:true,request_type:da};Object.assign(ia,ea);new h('/ajax/notifications/negative_req.php').setData(ia).setHandler(fa||p).setErrorHandler(ga||p).send();}function z(ca,da,ea,fa,ga){var ha=n.getURIBuilder().setInt('notif_id',k.untokenizeIDs([ca])[0]).setBool('undo',fa).setString('server_action',ga).getURI(),ia=function(ja){if(!ja.payload)throw new Error('No response from notif option!');l.handleUpdate(q,{hiddenState:o([ca],!ja.payload.visible)});da(ja.payload);};new h(ha).setHandler(ia||p).setErrorHandler(ea||p).send();}function aa(ca,da,ea,fa,ga){var ha=ga?t:s;j.getAll(function(ia){var ja=Object.keys(ia).filter(function(ka){var la=ia[ka];return !!(la.application&&la.application.id&&la.application.id==da);});y(ca,ha,null,function(ka){ea(ka);l.handleUpdate(q,{hiddenState:o(ja,!ga)});},fa);});}var ba={markNotificationsAsSeen:function(ca){l.handleUpdate(q,{seenState:o(ca)});var da=k.untokenizeIDs(ca),ea=x(da);ea.seen=true;w(ea);},setNextIsFromReadButton:function(ca){v=ca;},markNotificationsAsRead:function(ca){l.handleUpdate(q,{readState:o(ca)});var da=k.untokenizeIDs(ca),ea=x(da);if(v){ea.from_read_button=true;v=false;}w(ea);},sendNotifOption:function(ca,da,ea,fa){z(ca,da,ea,false,fa);},undoNotifOption:function(ca,da,ea,fa){z(ca,da,ea,true,fa);},markNotificationAsHidden:function(ca,da,ea){l.handleUpdate(q,{hiddenState:o([ca])});y(ca,s,null,da,ea);},markNotificationAsVisible:function(ca,da,ea,fa){l.handleUpdate(q,{hiddenState:o([ca],false)});var ga=null;if(da!==null){ga={};ga[u]=da;}y(ca,t,ga,ea,fa);},markNotificationAsSpam:function(ca,da,ea){l.handleUpdate(q,{hiddenState:o([ca],true)});y(ca,r,null,da,ea);},markAppAsHidden:function(ca,da,ea,fa){var ga=false;aa(ca,da,ea,fa,ga);},markAppAsVisible:function(ca,da,ea,fa){var ga=true;aa(ca,da,ea,fa,ga);}};f.exports=ba;},null);
__d('SplitImage.react',['React','Image.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.createClass({displayName:'SplitImage',render:function(){var m=this.props.size;return (h.createElement('div',babelHelpers['extends']({},this.props,{className:k(this.props.className,"_55lt"),style:babelHelpers['extends']({},this.props.style||{},{width:m,height:m})}),this.renderImages()));},renderImages:function(){if(!this.props.srcs)return null;var m=this.props.srcs,n=Array.isArray(m);if(n){m=m.filter(function(o){return o!==null;});if(!m.length)return null;}if(!n||m.length==1)return this.renderOne(n?m[0]:m);return m.length==2?this.renderTwo(m):this.renderThree(m);},renderOne:function(m){return (h.createElement(i,{src:m,width:this.props.size,height:this.props.size,alt:''}));},renderTwo:function(m){var n=this.props.size,o=Math.floor(n/2),p=-Math.floor(o/2),q="_55lu"+(this.props.border?' '+"_57xo":'');return (h.createElement('div',null,h.createElement('div',{className:"_55lu",style:{width:o}},h.createElement(i,{src:m[0],width:n,height:n,style:{marginLeft:p},alt:''})),h.createElement('div',{className:q,style:{width:o}},h.createElement(i,{src:m[1],width:n,height:n,style:{marginLeft:p},alt:''}))));},renderThree:function(m){var n=this.props.size,o=Math.floor(n/3*2),p=-Math.floor((n-o)/2),q=Math.floor(n/2),r=n-o,s=-Math.floor((q-r)/2),t="_55lu"+(this.props.border?' '+"_57pl":''),u="_55lu"+(this.props.border?' '+"_57pm":'');return (h.createElement('div',null,h.createElement('div',{className:t,style:{width:o}},h.createElement(i,{src:m[0],width:n,height:n,style:{marginLeft:p},alt:''})),h.createElement('div',{className:u,style:{width:r,height:q}},h.createElement(i,{src:m[1],width:q,height:q,style:{marginLeft:s},alt:''})),h.createElement('div',{className:"_55lu",style:{width:r,height:q}},h.createElement(i,{src:m[2],width:q,height:q,style:{marginLeft:s},alt:''}))));}});f.exports=l;},null);
__d('AbstractBadge.react',['React','cx','invariant','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes;function m(o){return parseInt(o,10)===o;}var n=h.createClass({displayName:'AbstractBadge',propTypes:{count:l.number.isRequired,maxcount:l.number},getDefaultProps:function(){return {maxcount:20};},render:function(){var o=this.props.count,p=this.props.maxcount;!m(o)?j(0):undefined;!m(p)?j(0):undefined;var q="_51lp"+(o>p?' '+"_51lr":'')+(o===0?' '+"hidden_elem":'');return (h.createElement('span',babelHelpers['extends']({},this.props,{className:k(this.props.className,q)}),o>p?p+'+':o));}});f.exports=n;},null);
__d('XUIBadge.react',['React','AbstractBadge.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'XUIBadge',propTypes:{type:l.oneOf(['regular','special'])},getDefaultProps:function(){return {type:'regular'};},render:function(){var n=this.props.type,o="_5ugh"+(n==='regular'?' '+"_5ugf":'')+(n==='special'?' '+"_5ugg":'');return (h.createElement(i,babelHelpers['extends']({},this.props,{className:k(this.props.className,o),type:null})));}});f.exports=m;},null);
__d('MercuryTypeaheadDataSource',['Banzai','BanzaiLogger','CurrentUser','DataSource','MercuryConfig','MercuryParticipantTypes','MercuryTypeaheadConstants','OrderedFriendsList','ShortProfiles','WorkModeConfig','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t;if(c.__markCompiled)c.__markCompiled();var u=500,v=[],w={},x={},y={},z=false,aa=false;s=babelHelpers.inherits(ba,k);t=s&&s.prototype;function ba(ca){'use strict';ca=ca||{};ca.kanaNormalization=true;t.constructor.call(this,ca);this.logQuery=r(function(da){this.$MercuryTypeaheadDataSource1(da);},u,this,true);this.logResponse=r(function(da){this.$MercuryTypeaheadDataSource1(da);},u,this,true);}ba.prototype.dirty=function(){'use strict';this.$MercuryTypeaheadDataSource2=v;this.localCache=x;this.queryCache=w;this.queryIDs=y;return this;};ba.prototype.bootstrap=function(){'use strict';if(z||aa)return false;this.$MercuryTypeaheadDataSource1({event:'bootstrap_start'});aa=true;p.fetchAll().then(function(){this.updateBootstrapData();this.$MercuryTypeaheadDataSource1({event:'bootstrap_end'});aa=false;z=true;}.bind(this),function(){this.$MercuryTypeaheadDataSource1({event:'bootstrap_failure'});}.bind(this));return true;};ba.prototype.updateBootstrapData=function(){'use strict';var ca=this.getCachedShortProfileIDs(),da=q.is_work_user?m.FB4C:m.FRIEND,ea=ca.map(function(fa){var ga=p.getNow(fa),ha=fa==j.getID()?da:ga.type,ia=[ga.additionalName,ga.alternateName].concat(ga.searchTokens||[]).join(' '),ja=ga.name,ka=null;if(ga.threadNickname){ja=ga.threadNickname;ka=ga.name;}return {uid:fa,index:o.getActiveRank(fa),text:ja,subtext:ka,tokens:ia,localized_text:ga.name,additional_text:ga.additionalName,photo:ga.thumbSrc,render_type:ha,type:n.USER_TYPE};});if(ea.length)this.addEntries(ea);};ba.prototype.query=function(ca,da,ea,fa){'use strict';var ga=da||ca.length===1;return t.query.call(this,ca,ga,ea,fa);};ba.prototype.getQueryData=function(ca,da){'use strict';return babelHelpers['extends']({},t.getQueryData.call(this,ca,da));};ba.prototype.setEntry=function(ca,da){'use strict';this.$MercuryTypeaheadDataSource2[ca]=da;};ba.prototype.getEntry=function(ca){'use strict';return this.$MercuryTypeaheadDataSource2[ca]||null;};ba.prototype.getCachedShortProfileIDs=function(){'use strict';var ca=p.getCachedProfileIDs(),da=ca.filter(function(ea){var fa=p.getNow(ea);return (ea==j.getID()||fa.type===m.FRIEND||fa.type===m.FB4C||fa.type===m.PAGE&&l.LinkedAgents&&l.LinkedAgents.indexOf(ea.toString())>-1);});return da;};ba.prototype.isBootstrapped=function(){'use strict';return z;};ba.prototype.isBootstrapping=function(){'use strict';return aa;};ba.prototype.processEntries=function(ca,da){'use strict';ca=ca.map(function(ea){if(ea.index==null&&(ea.render_type===m.FRIEND||ea.render_type===m.FB4C))ea.index=o.getActiveRank(ea.uid);if(ea.render_type===m.PAGE&&l.LinkedAgents&&l.LinkedAgents.indexOf(ea.uid.toString())>-1)ea.index=1;return ea;});return t.processEntries.call(this,ca);};ba.prototype.mergeUids=function(ca,da,ea,fa){'use strict';var ga=da.sort(function(ha,ia){return this.getEntry(ha).index-this.getEntry(ia).index;}.bind(this));return t.mergeUids.call(this,ca,ga,ea,fa);};ba.prototype.$MercuryTypeaheadDataSource1=function(ca){'use strict';if(!h.isEnabled('mercury_typeahead_logging'))return;i.log('MercuryQueryResultsLoggerConfig',ca);};f.exports=ba;},null);
__d('MercuryThreadSearchUtils',['escapeRegex','TokenizeUtil'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={wordsInString:function(k){return (k||'').split(/\s+/).filter(function(l){return l.trim().length>0;});},anyMatchPredicate:function(k,l){for(var m=0;m<k.length;m++)if(l(k[m]))return true;return false;},allMatchPredicate:function(k,l){for(var m=0;m<k.length;m++)if(!l(k[m]))return false;return true;},queryWordMatchesAnyNameWord:function(k,l){var m=new RegExp('^'+h(k),'i');return this.anyMatchPredicate(l,function(n){var o=i.parse(n).flatValue;return m.test(o);});},queryMatchesName:function(k,l){var m=this.wordsInString(k),n=this.wordsInString(l);return this.allMatchPredicate(m,function(o){return this.queryWordMatchesAnyNameWord(o,n);}.bind(this));}};f.exports=j;},null);
__d('NotificationJewelReminderLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports={init:function(i){h('NotificationJewelReminder').load().done(function(j){new j(i);});}};},null);
__d('ClearableTypeahead',['Event'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={resetOnCloseButtonClick:function(j,k){h.listen(k,'click',function(){var l=j.getCore();l.getElement().focus();l.reset();});}};f.exports=i;},null);
__d('TypeaheadRegulateMemorializedUsers',['TokenizeUtil'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype._filter=function(j,k){'use strict';if(j.type!=='user'||!j.memorialized)return true;var l=h.parse(j.text).tokens;if(l.length===1&&h.isExactMatch(k,j.text))return true;var m=this._typeahead.getData().getTextToIndex(j),n=h.parse(k).tokens;return n.length>1&&h.isQueryMatch(k,m);};i.prototype.enable=function(){'use strict';this._filterRegistry=this._typeahead.getData().addFilter(this._filter.bind(this));};i.prototype.disable=function(){'use strict';this._filterRegistry.remove();this._filterRegistry=null;};Object.assign(i.prototype,{_filterRegistry:null});f.exports=i;},null);
__d('legacy:RegulateMemorializedUsersTypeaheadBehavior',['TypeaheadRegulateMemorializedUsers'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.regulateMemorializedUsers=function(i){i.enableBehavior(h);};},3);
__d('TypeaheadShowLoadingIndicator',['CSS'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype.enable=function(){'use strict';this._subscription=this._typeahead.subscribe('loading',function(j,k){h.conditionClass(this._typeahead.getElement(),'typeaheadLoading',k.loading);h.conditionClass(this._typeahead.getView().getElement(),'typeaheadViewLoading',k.loading);}.bind(this));};i.prototype.disable=function(){'use strict';this._typeahead.unsubscribe(this._subscription);this._subscription=null;};Object.assign(i.prototype,{_subscription:null});f.exports=i;},null);
__d('legacy:ShowLoadingIndicatorTypeaheadBehavior',['TypeaheadShowLoadingIndicator'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.showLoadingIndicator=function(i){i.enableBehavior(h);};},3);
__d('legacy:CompactTypeaheadRenderer',['CompactTypeaheadRenderer'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadRenderers)b.TypeaheadRenderers={};b.TypeaheadRenderers.compact=c('CompactTypeaheadRenderer');},3);