/*!CK:3979056509!*//*1456170404,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["g5lui"]); }

__d('VideoUploadLeaveConfirmationDialog.react',['React','ReactLayeredComponentMixin','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogButton.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=h.PropTypes,q=h.createClass({displayName:'VideoUploadLeaveConfirmationDialog',mixins:[i],propTypes:{onContinue:p.func,onCancel:p.func},renderLayers:function(){return {dialog:h.createElement(j,{shown:true,layerHideOnBlur:false,width:700},h.createElement(k,null,o._("Discard Post?")),h.createElement(l,null,o._("If you leave now, this post will be discarded. To save your post, choose one of the options under the Publish button.")),h.createElement(m,null,h.createElement(n,{label:o._("Return to Post"),onClick:this.props.onContinue}),h.createElement(n,{use:'confirm',action:'cancel',label:o._("Discard"),onClick:this.props.onCancel})))};},render:function(){return h.createElement('div',null);}});f.exports=q;},null);
__d('VideoPermalinkText.react',['React','URI','cx'],function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();k=babelHelpers.inherits(m,h.Component);l=k&&k.prototype;m.prototype.$VideoPermalinkText1=function(){'use strict';return new i('/video.php').addQueryData('v',this.props.videoID).getQualifiedURI().toString();};m.prototype.render=function(){'use strict';return (h.createElement('div',{className:"_9_1"},this.$VideoPermalinkText1()));};function m(){'use strict';k.apply(this,arguments);}f.exports=m;},null);
__d('VideoUploadProcessingDialog.react',['ActorURI','React','ReactLayeredComponentMixin','VideoEditSource','VideoLibraryButton.react','VideoLibrarySource','VideoPermalinkText.react','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogCloseButton.react','XUIDialogButton.react','XVideoEditController','XVideoEditDialogController','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=i.PropTypes,y=i.createClass({displayName:'VideoUploadProcessingDialog',mixins:[j],propTypes:{onClose:x.func,shouldShowNewEditDialog:x.bool,isReferenceVideo:x.bool,shouldShowVideoLibrary:x.bool},getInitialState:function(){return {dialogShown:true};},_onToggle:function(z){this.setState({dialogShown:z});if(!z&&this.props.onClose)this.props.onClose();},_onEditVideoButtonClick:function(){this.setState({dialogShown:false});},componentWillReceiveProps:function(z){if(z.show)this.setState({dialogShown:true});},_getProcessingText:function(){if(this.props.isReferenceVideo){return w._("Your reference file is now processing. We will send you a notification when it's ready and monitored.");}else if(this.props.isSecretVideo){return (i.createElement('div',null,w._("Your secret video is now processing. We will notify you when it is it ready to view at the following location:"),i.createElement(n,{videoID:this.props.videoID})));}else return w._("Your video is now processing. We will send you a notification when it's ready to view.");},_getTitle:function(){return this.props.isSecretVideo?w._("Processing Secret Video"):w._("Processing Video");},renderLayers:function(){var z,aa=w._("Edit Video"),ba;if(this.props.isReferenceVideo){ba=null;}else if(this.props.shouldShowNewEditDialog&&this.props.pageID){z=v.getURIBuilder().setInt('video_id',this.props.videoID).setEnum('source',k.PROCESSING_DIALOG).getURI();z=h.create(z,this.props.pageID);ba=i.createElement(t,{action:'confirm',label:aa,href:z,onClick:this._onEditVideoButtonClick,rel:'dialog'});}else{z=u.getURIBuilder().setInt('v',this.props.videoID).setEnum('source',k.PROCESSING_DIALOG).getURI();ba=i.createElement(t,{action:'confirm',label:aa,href:z,onClick:this._onEditVideoButtonClick,target:'_blank'});}var ca=null;if(this.props.shouldShowVideoLibrary)ca=i.createElement(l,{pageID:this.props.pageID,size:'medium',source:m.VIDEO_UPLOAD_CONFIRMATION_DIALOG});return {dialog:i.createElement(o,{shown:this.state.dialogShown,width:400,onToggle:this._onToggle},i.createElement(p,null,this._getTitle()),i.createElement(q,null,this._getProcessingText()),i.createElement(r,{leftContent:ca},i.createElement(s,null),ba))};},render:function(){return i.createElement('span',null);}});f.exports=y;},null);
__d('ComposerXVideoUploadDialog.react',['Arbiter','DOMContainer.react','Image.react','React','ReactLayeredComponentMixin','SubscriptionsHandler','VideoUploadProcessingDialog.react','XUICloseButton.react','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','VideoUploadLeaveConfirmationDialog.react','OptimisticVideoPostUtils','cx','ix','fbt','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y=k.PropTypes,z=770,aa=489,ba=k.createClass({displayName:'ComposerXVideoUploadDialog',mixins:[l],_subscriptionsHandler:null,propTypes:{composer:y.object.isRequired,composerID:y.string.isRequired,canShowOptimisticPost:y.bool,showProcessingDialog:y.bool,onCancel:y.func,onComplete:y.func,onDone:y.func,compactMode:y.bool,isReferenceVideo:y.bool},getDefaultProps:function(){return {canShowOptimisticPost:false,showProcessingDialog:true,compactMode:false,isReferenceVideo:false};},getInitialState:function(){return {stage:'editing',videoID:null,showLeaveConfirmationDialog:false,showThrobber:false,shouldShowNewEditDialog:false,pageID:null,isSecretVideo:false,shouldShowVideoLibrary:false};},componentDidMount:function(){var ca=new m();this._subscriptionsHandler=ca;ca.addSubscriptions(h.subscribe('videoUpload/started',function(da){this.setState({stage:'editing',videoID:null});}.bind(this)),h.subscribe('videoUpload/complete',function(da,ea){if(this.props.onComplete)this.props.onComplete(ea.videoID);var fa=this.props.showProcessingDialog&&(!this.props.canShowOptimisticPost||!t.shouldShowOptimisticPost(ea));this.setState({stage:'finished',videoID:ea.videoID,shouldShowVideoUploadProcessingDialog:fa,shouldShowNewEditDialog:!!ea.shouldShowNewEditDialog,pageID:ea.pageID,isSecretVideo:ea.isSecret,shouldShowVideoLibrary:!!ea.shouldShowVideoLibrary});}.bind(this)),h.subscribe('videoUpload/showThrobber',function(da,ea){if(this.props.composerID===ea.composerID)this.setState({showThrobber:true});}.bind(this)),h.subscribe('videoUpload/hideThrobber',function(da,ea){if(this.props.composerID===ea.composerID)this.setState({showThrobber:false});}.bind(this)));},componentWillUnmount:function(){if(this._subscriptionsHandler)this._subscriptionsHandler.release();},onCancelPostingClick:function(){this.setState({showLeaveConfirmationDialog:false});if(this.props&&this.props.onCancel)this.props.onCancel();},onContinuePostingClick:function(){this.setState({showLeaveConfirmationDialog:false});},onComposerDialogClose:function(){this.setState({showLeaveConfirmationDialog:true});},onDone:function(){if(this.props&&this.props.onDone){var ca=this.props.onDone;x(function(){return ca({videoID:this.state.videoID});}.bind(this));}},renderLayers:function(){if(this.state.stage=='finished'){if(!this.state.shouldShowVideoUploadProcessingDialog){this.onDone();return {};}return {dialog:k.createElement(n,{videoID:this.state.videoID,onClose:this.onDone,show:true,shouldShowNewEditDialog:this.state.shouldShowNewEditDialog,pageID:this.state.pageID,isReferenceVideo:this.props.isReferenceVideo,isSecretVideo:this.state.isSecretVideo,shouldShowVideoLibrary:this.state.shouldShowVideoLibrary})};}else{var ca;if(this.props.isReferenceVideo){ca=w._("Add Reference File");}else ca=w._("Upload Video");return {dialog:k.createElement(p,{shown:true,layerHideOnBlur:false,width:this.props.compactMode?aa:z,fixedTopPosition:100},k.createElement(r,{showCloseButton:false},ca,k.createElement('div',{className:"_51-u"},this.renderThrobber(),k.createElement(o,{onClick:this.onComposerDialogClose,className:"_51-t"}))),k.createElement(q,{useCustomPadding:true},k.createElement(i,null,this.props.composer)))};}},renderThrobber:function(){return (k.createElement(j,{className:"_2z4p"+(this.state.showThrobber?' '+"_2z4q":''),src:v('/images/loaders/indicator_blue_small.gif')}));},render:function(){var ca;if(this.state.showLeaveConfirmationDialog)ca=k.createElement(s,{onContinue:this.onContinuePostingClick,onCancel:this.onCancelPostingClick});return (k.createElement('div',null,ca));}});f.exports=ba;},null);
__d("XComposerXVideoUploadDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/composerx\/video\/dialog\/",{target_id:{type:"Int",required:true},source_id:{type:"String",required:true},entry_point:{type:"Enum",required:true,enumType:1},is_reference_video:{type:"Bool",defaultValue:false}});},null);
__d('ComposerXVideoUploadDialogController',['ActorURI','Arbiter','AsyncDialog','AsyncRequest','ComposerEntryPointRef','ComposerXVideoUploadDialog.react','DOM','React','ReactDOM','URI','XComposerXVideoUploadDialogController','goURI','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u={};function v(aa){return u[aa];}function w(aa){u[aa.getID()]=aa;}function x(aa){return aa in u;}var y=l.TIMELINE;function z(aa,ba,ca,da,ea,fa,ga){'use strict';this.$ComposerXVideoUploadDialogController1=aa;this.$ComposerXVideoUploadDialogController2=ba;this.$ComposerXVideoUploadDialogController3=ca;this.$ComposerXVideoUploadDialogController4=da;this.$ComposerXVideoUploadDialogController5=ea;this.$ComposerXVideoUploadDialogController6=fa;this.$ComposerXVideoUploadDialogController7=ga;this.$ComposerXVideoUploadDialogController8=z.$ComposerXVideoUploadDialogController9(this.$ComposerXVideoUploadDialogController1,this.$ComposerXVideoUploadDialogController3,this.$ComposerXVideoUploadDialogController6);this.$ComposerXVideoUploadDialogController10=false;this.$ComposerXVideoUploadDialogController11=n.create('span');n.appendContent(document.body,this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController12();}z.prototype.getID=function(){'use strict';return this.$ComposerXVideoUploadDialogController8;};z.prototype.setFileInput=function(aa){'use strict';this.$ComposerXVideoUploadDialogController2=aa;};z.prototype.$ComposerXVideoUploadDialogController13=function(aa){'use strict';this.$ComposerXVideoUploadDialogController14=aa;if(this.$ComposerXVideoUploadDialogController15)this.show();};z.prototype.$ComposerXVideoUploadDialogController12=function(){'use strict';var aa=r.getURIBuilder().setInt('target_id',this.$ComposerXVideoUploadDialogController1).setString('source_id',this.$ComposerXVideoUploadDialogController8).setEnum('entry_point',this.$ComposerXVideoUploadDialogController3).setBool('is_reference_video',this.$ComposerXVideoUploadDialogController7).getURI();aa=h.create(aa,this.$ComposerXVideoUploadDialogController1);j.send(new k(aa));};z.prototype.$ComposerXVideoUploadDialogController16=function(){'use strict';p.render(o.createElement(m,{canShowOptimisticPost:this.$ComposerXVideoUploadDialogController5,composer:this.$ComposerXVideoUploadDialogController14,composerID:this.$ComposerXVideoUploadDialogController8,isReferenceVideo:this.$ComposerXVideoUploadDialogController7,showProcessingDialog:!this.$ComposerXVideoUploadDialogController4,onCancel:this.$ComposerXVideoUploadDialogController17.bind(this),onDone:this.$ComposerXVideoUploadDialogController18.bind(this)}),this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController10=true;};z.prototype.show=function(){'use strict';if(this.$ComposerXVideoUploadDialogController14){this.$ComposerXVideoUploadDialogController15=false;i.inform('ComposerXFilesStore/filesAdded/'+this.$ComposerXVideoUploadDialogController8+'/videoupload',{fileInput:this.$ComposerXVideoUploadDialogController2},i.BEHAVIOR_PERSISTENT);this.$ComposerXVideoUploadDialogController16();}else this.$ComposerXVideoUploadDialogController15=true;};z.prototype.$ComposerXVideoUploadDialogController17=function(){'use strict';i.inform('videoUpload/cancel',{composerID:this.$ComposerXVideoUploadDialogController8});this.hide();};z.prototype.$ComposerXVideoUploadDialogController18=function(aa){'use strict';this.hide();if(this.$ComposerXVideoUploadDialogController4)s(new q('/'+aa.videoID),true);};z.prototype.hide=function(){'use strict';p.unmountComponentAtNode(this.$ComposerXVideoUploadDialogController11);this.$ComposerXVideoUploadDialogController10=false;};z.$ComposerXVideoUploadDialogController9=function(aa,ba,ca){'use strict';if(ca){return ca;}else return ba+'_'+aa;};z.showDialog=function(aa){'use strict';aa.composerEntryPointRef=aa.composerEntryPointRef||y;var ba=z.$ComposerXVideoUploadDialogController9(aa.targetID,aa.composerEntryPointRef,aa.originalComposerID);if(!x(ba)){w(new z(aa.targetID,aa.fileInput,aa.composerEntryPointRef,aa.redirectToPermalinkOnPost||false,aa.canShowOptimisticPost||false,aa.originalComposerID||'',aa.isReferenceVideoUpload||false));}else v(ba).setFileInput(aa.fileInput);v(ba).show();};z.setVideoComposer=function(aa,ba){'use strict';if(u[aa])u[aa].$ComposerXVideoUploadDialogController13(ba);};f.exports=z;},null);
__d('PhotoInlineOrganizer',['AsyncRequest','AsyncResponse','CSS','DOM','Event','Parent','SortableGroup','$'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(q,r){'use strict';this.root=o(q);this.url=r;this.IDLE='idle';this.PENDING='pending';this.SAVING='saving';this.UP='up';this.DOWN='down';this.state=this.IDLE;this.sortable=new n();this.sortable.setAutoWidth(p.autoWidth);this.sortable.setRequireSameParent(false);this.sortable.setSortablesGetter(function(){return k.scry(this.root,'div.dragWrapper');}.bind(this));this.sortable.setInsertPlaceholderHandler(this.insertPlaceholder.bind(this));this.sortable.setOrderChangeHandler(this.onSave.bind(this));p.cache[q]=this;p.refresh(q);this.order=this.sortable.getOrder();this.offsetDelta=0;l.listen(this.root,'click',this.moveListener.bind(this));}p.prototype.getItems=function(){'use strict';return k.scry(this.root,'div.dragWrapper').filter(function(q){return !j.hasClass(q,'drag');});};p.prototype.moveListener=function(event){'use strict';var q=event.getTarget();if(j.hasClass(q,'arrow')){this.movePhoto(m.byClass(q,'dragWrapper'),j.hasClass(q,this.DOWN)?this.DOWN:this.UP);q.focus();return false;}};p.prototype.movePhoto=function(q,r){'use strict';var s=k.scry(this.root,'td'),t=this.getItems(),u=t.indexOf(q),v=0;if(r==this.UP&&u>0){v=-1;}else if(r==this.DOWN&&u<t.length-1)v=1;if(v!==0){k.appendContent(s[u+this.offsetDelta],t[u+v]);k.appendContent(s[u+v+this.offsetDelta],t[u]);}this.onSave();};p.prototype.save=function(){'use strict';if(this.state!=this.IDLE){this.state=this.PENDING;}else{this.state=this.SAVING;new h().setURI(this.url).setMethod('POST').setData({order:this.order}).setHandler(this.saveResponse.bind(this)).setErrorHandler(this.saveResponse.bind(this)).send();}};p.prototype.saveResponse=function(q){'use strict';var r=this.state;this.state=this.IDLE;if(r==this.PENDING)this.save();if(q.getError())i.verboseErrorHandler(q);};p.prototype.onSave=function(){'use strict';var q=this.sortable.getOrder();if(q.join('|')!=this.order.join('|')){this.order=q;this.save();}};p.prototype.insertPlaceholder=function(q,r,s){'use strict';var t=k.scry(this.root,'td'),u=this.getItems(),v=u.indexOf(r),w=u.indexOf(q),x;if(v>w){for(x=w;x<v;x++)k.appendContent(t[x+this.offsetDelta],u[x+1]);}else for(x=w-1;x>=v;x--)k.appendContent(t[x+1+this.offsetDelta],u[x]);k.appendContent(t[v+this.offsetDelta],q);};p.refresh=function(q){'use strict';var r=p.cache[q];k.scry(r.root,'td').forEach(function(s){if(s.getAttribute('data-id')){var t=k.find(s,'div.dragWrapper'),u=k.find(t,'a.uiMediaThumb');r.sortable.addSortable(s.getAttribute('data-id'),t,u);s.removeAttribute('data-id');}});};p.getInlineOrganizer=function(q){'use strict';var r=o(q),s=k.scry(r,'table')[0];return p.cache[s.id];};p.setOffsetDelta=function(q,r){'use strict';var s=p.getInlineOrganizer(q);s.offsetDelta=Math.max(s.offsetDelta,r);};p.setAutoWidth=function(q,r){'use strict';var s=p.getInlineOrganizer(q);s.sortable.setAutoWidth(r);};p.appendToExisting=function(q,r){'use strict';var s=p.getInlineOrganizer(q),t=k.find(s.root,'tbody'),u=o(r),v=k.find(u,'table');k.scry(v,'tr').forEach(function(x){t.appendChild(x);});var w=k.scry(u,'.uiMorePager');if(w.length>0)u.appendChild(w[0].parentNode);p.refresh(s.root.id);};p.cache={};f.exports=p;},null);
__d('legacy:photo-inline-organizer-js',['PhotoInlineOrganizer'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();b.PhotoInlineOrganizer=c('PhotoInlineOrganizer');},3);
__d('VideoComposerUploadFileInput',['ComposerXVideoUploadDialogController'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j,k,l,m){'use strict';j.subscribe('change',function(n,event){var o=false,p=false;if(m){o=m.redirectToPermalinkOnPost;p=m.canShowOptimisticPost;}h.showDialog({targetID:k,fileInput:j,composerEntryPointRef:l,redirectToPermalinkOnPost:o,canShowOptimisticPost:p});});}f.exports=i;},null);